(function (factory) {
    if (typeof module === 'object' && typeof module.exports === 'object') {
        var v = factory(require, exports); if (v !== undefined) module.exports = v;
    }
    else if (typeof define === 'function' && define.amd) {
        define(["require", "exports"], factory);
    }
})(function (require, exports) {
    "use strict";
    var days = [null, 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
    var isLeapYear = (function () {
        var date = new Date();
        function isLeapYear(year) {
            date.setFullYear(year, 1, 29);
            return date.getDate() === 29;
        }
        return isLeapYear;
    })();
    var operationOrder = ['years', 'months', 'days', 'hours', 'minutes', 'seconds', 'milliseconds'];
    var operationHash = Object.create(null, {
        days: { value: 'Date' },
        hours: { value: 'UTCHours' },
        milliseconds: { value: 'UTCMilliseconds' },
        minutes: { value: 'UTCMinutes' },
        months: { value: 'Month' },
        seconds: { value: 'UTCSeconds' },
        years: { value: 'FullYear' }
    });
    var DateObject = (function () {
        function DateObject(value) {
            var _date;
            if (!arguments.length) {
                _date = new Date();
            }
            else if (value instanceof Date) {
                _date = new Date(+value);
            }
            else if (typeof value === 'number' || typeof value === 'string') {
                _date = new Date(value);
            }
            else {
                _date = new Date(value.year, value.month - 1, value.dayOfMonth || 1, value.hours || 0, value.minutes || 0, value.seconds || 0, value.milliseconds || 0);
            }
            Object.defineProperty(this, '_date', {
                configurable: true,
                enumerable: false,
                value: _date,
                writable: true
            });
            var self = this;
            Object.defineProperty(this, 'utc', {
                value: {
                    get isLeapYear() {
                        return isLeapYear(this.year);
                    },
                    get daysInMonth() {
                        var month = this.month;
                        if (month === 2 && this.isLeapYear) {
                            return 29;
                        }
                        return days[month];
                    },
                    get year() {
                        return self._date.getUTCFullYear();
                    },
                    set year(year) {
                        self._date.setUTCFullYear(year);
                    },
                    get month() {
                        return self._date.getUTCMonth() + 1;
                    },
                    set month(month) {
                        self._date.setUTCMonth(month - 1);
                    },
                    get dayOfMonth() {
                        return self._date.getUTCDate();
                    },
                    set dayOfMonth(day) {
                        self._date.setUTCDate(day);
                    },
                    get hours() {
                        return self._date.getUTCHours();
                    },
                    set hours(hours) {
                        self._date.setUTCHours(hours);
                    },
                    get minutes() {
                        return self._date.getUTCMinutes();
                    },
                    set minutes(minutes) {
                        self._date.setUTCMinutes(minutes);
                    },
                    get seconds() {
                        return self._date.getUTCSeconds();
                    },
                    set seconds(seconds) {
                        self._date.setUTCSeconds(seconds);
                    },
                    get milliseconds() {
                        return self._date.getUTCMilliseconds();
                    },
                    set milliseconds(milliseconds) {
                        self._date.setUTCMilliseconds(milliseconds);
                    },
                    get dayOfWeek() {
                        return self._date.getUTCDay();
                    },
                    toString: function () {
                        return self._date.toUTCString();
                    }
                },
                enumerable: true
            });
        }
        DateObject.parse = function (string) {
            return new DateObject(Date.parse(string));
        };
        DateObject.now = function () {
            return new DateObject(Date.now());
        };
        Object.defineProperty(DateObject.prototype, "isLeapYear", {
            get: function () {
                return isLeapYear(this.year);
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(DateObject.prototype, "daysInMonth", {
            get: function () {
                var month = this.month;
                if (month === 2 && this.isLeapYear) {
                    return 29;
                }
                return days[month];
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(DateObject.prototype, "year", {
            get: function () {
                return this._date.getFullYear();
            },
            set: function (year) {
                var dayOfMonth = this.dayOfMonth;
                this._date.setFullYear(year);
                if (this.dayOfMonth < dayOfMonth) {
                    this.dayOfMonth = 0;
                }
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(DateObject.prototype, "month", {
            get: function () {
                return this._date.getMonth() + 1;
            },
            set: function (month) {
                var dayOfMonth = this.dayOfMonth;
                this._date.setMonth(month - 1);
                if (this.dayOfMonth < dayOfMonth) {
                    this.dayOfMonth = 0;
                }
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(DateObject.prototype, "dayOfMonth", {
            get: function () {
                return this._date.getDate();
            },
            set: function (day) {
                this._date.setDate(day);
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(DateObject.prototype, "hours", {
            get: function () {
                return this._date.getHours();
            },
            set: function (hours) {
                this._date.setHours(hours);
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(DateObject.prototype, "minutes", {
            get: function () {
                return this._date.getMinutes();
            },
            set: function (minutes) {
                this._date.setMinutes(minutes);
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(DateObject.prototype, "seconds", {
            get: function () {
                return this._date.getSeconds();
            },
            set: function (seconds) {
                this._date.setSeconds(seconds);
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(DateObject.prototype, "milliseconds", {
            get: function () {
                return this._date.getMilliseconds();
            },
            set: function (milliseconds) {
                this._date.setMilliseconds(milliseconds);
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(DateObject.prototype, "time", {
            get: function () {
                return this._date.getTime();
            },
            set: function (time) {
                this._date.setTime(time);
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(DateObject.prototype, "dayOfWeek", {
            get: function () {
                return this._date.getDay();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(DateObject.prototype, "timezoneOffset", {
            get: function () {
                return this._date.getTimezoneOffset();
            },
            enumerable: true,
            configurable: true
        });
        DateObject.prototype.add = function (value) {
            var _this = this;
            var result = new DateObject(this.time);
            if (typeof value === 'number') {
                result.time += value;
            }
            else {
                // Properties have to be added in a particular order to properly handle
                // date overshoots in month and year calculations
                operationOrder.forEach(function (property) {
                    if (!(property in value)) {
                        return;
                    }
                    var dateMethod = operationHash[property];
                    result._date[("set" + dateMethod)](_this._date[("get" + dateMethod)]() + value[property]);
                    if ((property === 'years' || property === 'months') &&
                        result.dayOfMonth < _this.dayOfMonth) {
                        // Set the day of the month to 0 to move the date to the first day of the previous
                        // month to fix overshoots when adding a month and the date is the 31st or adding
                        // a year and the date is the 29th
                        result.dayOfMonth = 0;
                    }
                });
            }
            return result;
        };
        DateObject.prototype.compare = function (value) {
            var result = this.time - value.time;
            if (result > 0) {
                return 1;
            }
            if (result < 0) {
                return -1;
            }
            return 0;
        };
        DateObject.prototype.compareDate = function (value) {
            var left = new DateObject(this);
            var right = new DateObject(value);
            left._date.setHours(0, 0, 0, 0);
            right._date.setHours(0, 0, 0, 0);
            return left.compare(right);
        };
        DateObject.prototype.compareTime = function (value) {
            var left = new DateObject(this);
            var right = new DateObject(value);
            left._date.setFullYear(0, 0, 0);
            right._date.setFullYear(0, 0, 0);
            return left.compare(right);
        };
        DateObject.prototype.toString = function () {
            return this._date.toString();
        };
        DateObject.prototype.toDateString = function () {
            return this._date.toDateString();
        };
        DateObject.prototype.toTimeString = function () {
            return this._date.toTimeString();
        };
        DateObject.prototype.toLocaleString = function () {
            return this._date.toLocaleString();
        };
        DateObject.prototype.toLocaleDateString = function () {
            return this._date.toLocaleDateString();
        };
        DateObject.prototype.toLocaleTimeString = function () {
            return this._date.toLocaleTimeString();
        };
        DateObject.prototype.toISOString = function () {
            return this._date.toISOString();
        };
        DateObject.prototype.toJSON = function (key) {
            return this._date.toJSON(key);
        };
        DateObject.prototype.valueOf = function () {
            return this._date.valueOf();
        };
        return DateObject;
    }());
    Object.defineProperty(exports, "__esModule", { value: true });
    exports.default = DateObject;
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRGF0ZU9iamVjdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9EYXRlT2JqZWN0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztJQXNDQSxJQUFNLElBQUksR0FBRyxDQUFFLElBQUksRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsQ0FBRSxDQUFDO0lBRXRFLElBQU0sVUFBVSxHQUFHLENBQUM7UUFDbkIsSUFBTSxJQUFJLEdBQUcsSUFBSSxJQUFJLEVBQUUsQ0FBQztRQUN4QixvQkFBb0IsSUFBWTtZQUMvQixJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUM7WUFDOUIsTUFBTSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsS0FBSyxFQUFFLENBQUM7UUFDOUIsQ0FBQztRQUNELE1BQU0sQ0FBQyxVQUFVLENBQUM7SUFDbkIsQ0FBQyxDQUFDLEVBQUUsQ0FBQztJQUVMLElBQU0sY0FBYyxHQUFHLENBQUUsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUUsT0FBTyxFQUFFLFNBQVMsRUFBRSxTQUFTLEVBQUUsY0FBYyxDQUFFLENBQUM7SUFDcEcsSUFBTSxhQUFhLEdBQWlCLE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBSSxFQUFFO1FBQ3ZELElBQUksRUFBRSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUU7UUFDdkIsS0FBSyxFQUFFLEVBQUUsS0FBSyxFQUFFLFVBQVUsRUFBRTtRQUM1QixZQUFZLEVBQUUsRUFBRSxLQUFLLEVBQUUsaUJBQWlCLEVBQUU7UUFDMUMsT0FBTyxFQUFFLEVBQUUsS0FBSyxFQUFFLFlBQVksRUFBRTtRQUNoQyxNQUFNLEVBQUUsRUFBRSxLQUFLLEVBQUUsT0FBTyxFQUFFO1FB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QyxDQUFDO1FBQ0QsbUNBQWMsR0FBZDtZQUNDLE1BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLGNBQWMsRUFBRSxDQUFDO1FBQ3BDLENBQUM7UUFDRCx1Q0FBa0IsR0FBbEI7WUFDQyxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxrQkFBa0IsRUFBRSxDQUFDO1FBQ3hDLENBQUM7UUFDRCx1Q0FBa0IsR0FBbEI7WUFDQyxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxrQkFBa0IsRUFBRSxDQUFDO1FBQ3hDLENBQUM7UUFDRCxnQ0FBVyxHQUFYO1lBQ0MsTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsV0FBVyxFQUFFLENBQUM7UUFDakMsQ0FBQztRQUNELDJCQUFNLEdBQU4sVUFBTyxHQUFTO1lBQ2YsTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQy9CLENBQUM7UUFDRCw0QkFBTyxHQUFQO1lBQ0MsTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxFQUFFLENBQUM7UUFDN0IsQ0FBQztRQUNGLGlCQUFDO0lBQUQsQ0FBQyxBQS9TRCxJQStTQztJQS9TRDtnQ0ErU0MsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEhhc2ggfSBmcm9tICcuL2ludGVyZmFjZXMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIEt3QXJncyB7XG5cdGRheU9mTW9udGg/OiBudW1iZXI7XG5cdGhvdXJzPzogbnVtYmVyO1xuXHRtaWxsaXNlY29uZHM/OiBudW1iZXI7XG5cdG1pbnV0ZXM/OiBudW1iZXI7XG5cdG1vbnRoOiBudW1iZXI7XG5cdHNlY29uZHM/OiBudW1iZXI7XG5cdHllYXI6IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBPcGVyYXRpb25Ld0FyZ3Mge1xuXHRkYXlzPzogbnVtYmVyO1xuXHRob3Vycz86IG51bWJlcjtcblx0bWlsbGlzZWNvbmRzPzogbnVtYmVyO1xuXHRtaW51dGVzPzogbnVtYmVyO1xuXHRtb250aHM/OiBudW1iZXI7XG5cdHNlY29uZHM/OiBudW1iZXI7XG5cdHllYXJzPzogbnVtYmVyO1xufVxuXG4vKipcbiAqIFRoZSBwcm9wZXJ0aWVzIG9mIGEgY29tcGxldGUgZGF0ZVxuICovXG5leHBvcnQgaW50ZXJmYWNlIERhdGVQcm9wZXJ0aWVzIHtcblx0ZGF5T2ZNb250aDogbnVtYmVyO1xuXHRkYXlPZldlZWs6IG51bWJlcjtcblx0ZGF5c0luTW9udGg6IG51bWJlcjtcblx0aG91cnM6IG51bWJlcjtcblx0aXNMZWFwWWVhcjogYm9vbGVhbjtcblx0bWlsbGlzZWNvbmRzOiBudW1iZXI7XG5cdG1pbnV0ZXM6IG51bWJlcjtcblx0bW9udGg6IG51bWJlcjtcblx0c2Vjb25kczogbnVtYmVyO1xuXHR5ZWFyOiBudW1iZXI7XG59XG5cbmNvbnN0IGRheXMgPSBbIG51bGwsIDMxLCAyOCwgMzEsIDMwLCAzMSwgMzAsIDMxLCAzMSwgMzAsIDMxLCAzMCwgMzEgXTtcblxuY29uc3QgaXNMZWFwWWVhciA9IChmdW5jdGlvbiAoKSB7XG5cdGNvbnN0IGRhdGUgPSBuZXcgRGF0ZSgpO1xuXHRmdW5jdGlvbiBpc0xlYXBZZWFyKHllYXI6IG51bWJlcik6IGJvb2xlYW4ge1xuXHRcdGRhdGUuc2V0RnVsbFllYXIoeWVhciwgMSwgMjkpO1xuXHRcdHJldHVybiBkYXRlLmdldERhdGUoKSA9PT0gMjk7XG5cdH1cblx0cmV0dXJuIGlzTGVhcFllYXI7XG59KSgpO1xuXG5jb25zdCBvcGVyYXRpb25PcmRlciA9IFsgJ3llYXJzJywgJ21vbnRocycsICdkYXlzJywgJ2hvdXJzJywgJ21pbnV0ZXMnLCAnc2Vjb25kcycsICdtaWxsaXNlY29uZHMnIF07XG5jb25zdCBvcGVyYXRpb25IYXNoOiBIYXNoPHN0cmluZz4gPSBPYmplY3QuY3JlYXRlKG51bGwsIHtcblx0ZGF5czogeyB2YWx1ZTogJ0RhdGUnIH0sXG5cdGhvdXJzOiB7IHZhbHVlOiAnVVRDSG91cnMnIH0sXG5cdG1pbGxpc2Vjb25kczogeyB2YWx1ZTogJ1VUQ01pbGxpc2Vjb25kcycgfSxcblx0bWludXRlczogeyB2YWx1ZTogJ1VUQ01pbnV0ZXMnIH0sXG5cdG1vbnRoczogeyB2YWx1ZTogJ01vbnRoJyB9LFxuXHRzZWNvbmRzOiB7IHZhbHVlOiAnVVRDU2Vjb25kcycgfSxcblx0eWVhcnM6IHsgdmFsdWU6ICdGdWxsWWVhcicgfVxufSk7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIERhdGVPYmplY3QgaW1wbGVtZW50cyBEYXRlUHJvcGVydGllcyB7XG5cdHN0YXRpYyBwYXJzZShzdHJpbmc6IHN0cmluZyk6IERhdGVPYmplY3Qge1xuXHRcdHJldHVybiBuZXcgRGF0ZU9iamVjdChEYXRlLnBhcnNlKHN0cmluZykpO1xuXHR9XG5cblx0c3RhdGljIG5vdygpOiBEYXRlT2JqZWN0IHtcblx0XHRyZXR1cm4gbmV3IERhdGVPYmplY3QoRGF0ZS5ub3coKSk7XG5cdH1cblxuXHRwcml2YXRlIF9kYXRlOiBEYXRlO1xuXHR1dGM6IERhdGVQcm9wZXJ0aWVzO1xuXG5cdGNvbnN0cnVjdG9yKHZhbHVlOiBudW1iZXIpO1xuXHRjb25zdHJ1Y3Rvcih2YWx1ZTogc3RyaW5nKTtcblx0Y29uc3RydWN0b3IodmFsdWU6IERhdGUpO1xuXHRjb25zdHJ1Y3Rvcih2YWx1ZTogS3dBcmdzKTtcblx0Y29uc3RydWN0b3IoKTtcblx0Y29uc3RydWN0b3IodmFsdWU/OiBhbnkpIHtcblx0XHRsZXQgX2RhdGU6IERhdGU7XG5cdFx0aWYgKCFhcmd1bWVudHMubGVuZ3RoKSB7XG5cdFx0XHRfZGF0ZSA9IG5ldyBEYXRlKCk7XG5cdFx0fVxuXHRcdGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgRGF0ZSkge1xuXHRcdFx0X2RhdGUgPSBuZXcgRGF0ZSgrdmFsdWUpO1xuXHRcdH1cblx0XHRlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInIHx8IHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHtcblx0XHRcdF9kYXRlID0gbmV3IERhdGUoPGFueT4gdmFsdWUpO1xuXHRcdH1cblx0XHRlbHNlIHtcblx0XHRcdF9kYXRlID0gbmV3IERhdGUoXG5cdFx0XHRcdHZhbHVlLnllYXIsXG5cdFx0XHRcdHZhbHVlLm1vbnRoIC0gMSxcblx0XHRcdFx0dmFsdWUuZGF5T2ZNb250aCB8fCAxLFxuXHRcdFx0XHR2YWx1ZS5ob3VycyB8fCAwLFxuXHRcdFx0XHR2YWx1ZS5taW51dGVzIHx8IDAsXG5cdFx0XHRcdHZhbHVlLnNlY29uZHMgfHwgMCxcblx0XHRcdFx0dmFsdWUubWlsbGlzZWNvbmRzIHx8IDBcblx0XHRcdCk7XG5cdFx0fVxuXG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICdfZGF0ZScsIHtcblx0XHRcdGNvbmZpZ3VyYWJsZTogdHJ1ZSxcblx0XHRcdGVudW1lcmFibGU6IGZhbHNlLFxuXHRcdFx0dmFsdWU6IF9kYXRlLFxuXHRcdFx0d3JpdGFibGU6IHRydWVcblx0XHR9KTtcblxuXHRcdGNvbnN0IHNlbGYgPSB0aGlzO1xuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAndXRjJywge1xuXHRcdFx0dmFsdWU6IHtcblx0XHRcdFx0Z2V0IGlzTGVhcFllYXIoKTogYm9vbGVhbiB7XG5cdFx0XHRcdFx0cmV0dXJuIGlzTGVhcFllYXIodGhpcy55ZWFyKTtcblx0XHRcdFx0fSxcblx0XHRcdFx0Z2V0IGRheXNJbk1vbnRoKCk6IG51bWJlciB7XG5cdFx0XHRcdFx0Y29uc3QgbW9udGggPSB0aGlzLm1vbnRoO1xuXG5cdFx0XHRcdFx0aWYgKG1vbnRoID09PSAyICYmIHRoaXMuaXNMZWFwWWVhcikge1xuXHRcdFx0XHRcdFx0cmV0dXJuIDI5O1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRyZXR1cm4gZGF5c1ttb250aF07XG5cdFx0XHRcdH0sXG5cblx0XHRcdFx0Z2V0IHllYXIoKTogbnVtYmVyIHtcblx0XHRcdFx0XHRyZXR1cm4gc2VsZi5fZGF0ZS5nZXRVVENGdWxsWWVhcigpO1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRzZXQgeWVhcih5ZWFyOiBudW1iZXIpIHtcblx0XHRcdFx0XHRzZWxmLl9kYXRlLnNldFVUQ0Z1bGxZZWFyKHllYXIpO1xuXHRcdFx0XHR9LFxuXG5cdFx0XHRcdGdldCBtb250aCgpOiBudW1iZXIge1xuXHRcdFx0XHRcdHJldHVybiBzZWxmLl9kYXRlLmdldFVUQ01vbnRoKCkgKyAxO1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRzZXQgbW9udGgobW9udGg6IG51bWJlcikge1xuXHRcdFx0XHRcdHNlbGYuX2RhdGUuc2V0VVRDTW9udGgobW9udGggLSAxKTtcblx0XHRcdFx0fSxcblxuXHRcdFx0XHRnZXQgZGF5T2ZNb250aCgpOiBudW1iZXIge1xuXHRcdFx0XHRcdHJldHVybiBzZWxmLl9kYXRlLmdldFVUQ0RhdGUoKTtcblx0XHRcdFx0fSxcblx0XHRcdFx0c2V0IGRheU9mTW9udGgoZGF5OiBudW1iZXIpIHtcblx0XHRcdFx0XHRzZWxmLl9kYXRlLnNldFVUQ0RhdGUoZGF5KTtcblx0XHRcdFx0fSxcblxuXHRcdFx0XHRnZXQgaG91cnMoKTogbnVtYmVyIHtcblx0XHRcdFx0XHRyZXR1cm4gc2VsZi5fZGF0ZS5nZXRVVENIb3VycygpO1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRzZXQgaG91cnMoaG91cnM6IG51bWJlcikge1xuXHRcdFx0XHRcdHNlbGYuX2RhdGUuc2V0VVRDSG91cnMoaG91cnMpO1xuXHRcdFx0XHR9LFxuXG5cdFx0XHRcdGdldCBtaW51dGVzKCk6IG51bWJlciB7XG5cdFx0XHRcdFx0cmV0dXJuIHNlbGYuX2RhdGUuZ2V0VVRDTWludXRlcygpO1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRzZXQgbWludXRlcyhtaW51dGVzOiBudW1iZXIpIHtcblx0XHRcdFx0XHRzZWxmLl9kYXRlLnNldFVUQ01pbnV0ZXMobWludXRlcyk7XG5cdFx0XHRcdH0sXG5cblx0XHRcdFx0Z2V0IHNlY29uZHMoKTogbnVtYmVyIHtcblx0XHRcdFx0XHRyZXR1cm4gc2VsZi5fZGF0ZS5nZXRVVENTZWNvbmRzKCk7XG5cdFx0XHRcdH0sXG5cdFx0XHRcdHNldCBzZWNvbmRzKHNlY29uZHM6IG51bWJlcikge1xuXHRcdFx0XHRcdHNlbGYuX2RhdGUuc2V0VVRDU2Vjb25kcyhzZWNvbmRzKTtcblx0XHRcdFx0fSxcblxuXHRcdFx0XHRnZXQgbWlsbGlzZWNvbmRzKCk6IG51bWJlciB7XG5cdFx0XHRcdFx0cmV0dXJuIHNlbGYuX2RhdGUuZ2V0VVRDTWlsbGlzZWNvbmRzKCk7XG5cdFx0XHRcdH0sXG5cdFx0XHRcdHNldCBtaWxsaXNlY29uZHMobWlsbGlzZWNvbmRzOiBudW1iZXIpIHtcblx0XHRcdFx0XHRzZWxmLl9kYXRlLnNldFVUQ01pbGxpc2Vjb25kcyhtaWxsaXNlY29uZHMpO1xuXHRcdFx0XHR9LFxuXG5cdFx0XHRcdGdldCBkYXlPZldlZWsoKTogbnVtYmVyIHtcblx0XHRcdFx0XHRyZXR1cm4gc2VsZi5fZGF0ZS5nZXRVVENEYXkoKTtcblx0XHRcdFx0fSxcblxuXHRcdFx0XHR0b1N0cmluZzogZnVuY3Rpb24gKCk6IHN0cmluZyB7XG5cdFx0XHRcdFx0cmV0dXJuIHNlbGYuX2RhdGUudG9VVENTdHJpbmcoKTtcblx0XHRcdFx0fVxuXHRcdFx0fSxcblx0XHRcdGVudW1lcmFibGU6IHRydWVcblx0XHR9KTtcblx0fVxuXG5cdGdldCBpc0xlYXBZZWFyKCk6IGJvb2xlYW4ge1xuXHRcdHJldHVybiBpc0xlYXBZZWFyKHRoaXMueWVhcik7XG5cdH1cblxuXHRnZXQgZGF5c0luTW9udGgoKTogbnVtYmVyIHtcblx0XHRjb25zdCBtb250aCA9IHRoaXMubW9udGg7XG5cblx0XHRpZiAobW9udGggPT09IDIgJiYgdGhpcy5pc0xlYXBZZWFyKSB7XG5cdFx0XHRyZXR1cm4gMjk7XG5cdFx0fVxuXHRcdHJldHVybiBkYXlzW21vbnRoXTtcblx0fVxuXG5cdGdldCB5ZWFyKCk6IG51bWJlciB7XG5cdFx0cmV0dXJuIHRoaXMuX2RhdGUuZ2V0RnVsbFllYXIoKTtcblx0fVxuXHRzZXQgeWVhcih5ZWFyOiBudW1iZXIpIHtcblx0XHRjb25zdCBkYXlPZk1vbnRoID0gdGhpcy5kYXlPZk1vbnRoO1xuXG5cdFx0dGhpcy5fZGF0ZS5zZXRGdWxsWWVhcih5ZWFyKTtcblxuXHRcdGlmICh0aGlzLmRheU9mTW9udGggPCBkYXlPZk1vbnRoKSB7XG5cdFx0XHR0aGlzLmRheU9mTW9udGggPSAwO1xuXHRcdH1cblx0fVxuXG5cdGdldCBtb250aCgpOiBudW1iZXIge1xuXHRcdHJldHVybiB0aGlzLl9kYXRlLmdldE1vbnRoKCkgKyAxO1xuXHR9XG5cdHNldCBtb250aChtb250aDogbnVtYmVyKSB7XG5cdFx0Y29uc3QgZGF5T2ZNb250aCA9IHRoaXMuZGF5T2ZNb250aDtcblxuXHRcdHRoaXMuX2RhdGUuc2V0TW9udGgobW9udGggLSAxKTtcblxuXHRcdGlmICh0aGlzLmRheU9mTW9udGggPCBkYXlPZk1vbnRoKSB7XG5cdFx0XHR0aGlzLmRheU9mTW9udGggPSAwO1xuXHRcdH1cblx0fVxuXG5cdGdldCBkYXlPZk1vbnRoKCk6IG51bWJlciB7XG5cdFx0cmV0dXJuIHRoaXMuX2RhdGUuZ2V0RGF0ZSgpO1xuXHR9XG5cdHNldCBkYXlPZk1vbnRoKGRheTogbnVtYmVyKSB7XG5cdFx0dGhpcy5fZGF0ZS5zZXREYXRlKGRheSk7XG5cdH1cblxuXHRnZXQgaG91cnMoKTogbnVtYmVyIHtcblx0XHRyZXR1cm4gdGhpcy5fZGF0ZS5nZXRIb3VycygpO1xuXHR9XG5cdHNldCBob3Vycyhob3VyczogbnVtYmVyKSB7XG5cdFx0dGhpcy5fZGF0ZS5zZXRIb3Vycyhob3Vycyk7XG5cdH1cblxuXHRnZXQgbWludXRlcygpOiBudW1iZXIge1xuXHRcdHJldHVybiB0aGlzLl9kYXRlLmdldE1pbnV0ZXMoKTtcblx0fVxuXHRzZXQgbWludXRlcyhtaW51dGVzOiBudW1iZXIpIHtcblx0XHR0aGlzLl9kYXRlLnNldE1pbnV0ZXMobWludXRlcyk7XG5cdH1cblxuXHRnZXQgc2Vjb25kcygpOiBudW1iZXIge1xuXHRcdHJldHVybiB0aGlzLl9kYXRlLmdldFNlY29uZHMoKTtcblx0fVxuXHRzZXQgc2Vjb25kcyhzZWNvbmRzOiBudW1iZXIpIHtcblx0XHR0aGlzLl9kYXRlLnNldFNlY29uZHMoc2Vjb25kcyk7XG5cdH1cblxuXHRnZXQgbWlsbGlzZWNvbmRzKCk6IG51bWJlciB7XG5cdFx0cmV0dXJuIHRoaXMuX2RhdGUuZ2V0TWlsbGlzZWNvbmRzKCk7XG5cdH1cblx0c2V0IG1pbGxpc2Vjb25kcyhtaWxsaXNlY29uZHM6IG51bWJlcikge1xuXHRcdHRoaXMuX2RhdGUuc2V0TWlsbGlzZWNvbmRzKG1pbGxpc2Vjb25kcyk7XG5cdH1cblxuXHRnZXQgdGltZSgpOiBudW1iZXIge1xuXHRcdHJldHVybiB0aGlzLl9kYXRlLmdldFRpbWUoKTtcblx0fVxuXHRzZXQgdGltZSh0aW1lOiBudW1iZXIpIHtcblx0XHR0aGlzLl9kYXRlLnNldFRpbWUodGltZSk7XG5cdH1cblxuXHRnZXQgZGF5T2ZXZWVrKCk6IG51bWJlciB7XG5cdFx0cmV0dXJuIHRoaXMuX2RhdGUuZ2V0RGF5KCk7XG5cdH1cblx0Z2V0IHRpbWV6b25lT2Zmc2V0KCk6IG51bWJlciB7XG5cdFx0cmV0dXJuIHRoaXMuX2RhdGUuZ2V0VGltZXpvbmVPZmZzZXQoKTtcblx0fVxuXG5cdGFkZCh2YWx1ZTogbnVtYmVyKTogRGF0ZU9iamVjdDtcblx0YWRkKHZhbHVlOiBPcGVyYXRpb25Ld0FyZ3MpOiBEYXRlT2JqZWN0O1xuXHRhZGQodmFsdWU6IGFueSk6IERhdGVPYmplY3Qge1xuXHRcdGNvbnN0IHJlc3VsdCA9IG5ldyBEYXRlT2JqZWN0KHRoaXMudGltZSk7XG5cblx0XHRpZiAodHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJykge1xuXHRcdFx0cmVzdWx0LnRpbWUgKz0gdmFsdWU7XG5cdFx0fVxuXHRcdGVsc2Uge1xuXHRcdFx0Ly8gUHJvcGVydGllcyBoYXZlIHRvIGJlIGFkZGVkIGluIGEgcGFydGljdWxhciBvcmRlciB0byBwcm9wZXJseSBoYW5kbGVcblx0XHRcdC8vIGRhdGUgb3ZlcnNob290cyBpbiBtb250aCBhbmQgeWVhciBjYWxjdWxhdGlvbnNcblx0XHRcdG9wZXJhdGlvbk9yZGVyLmZvckVhY2goKHByb3BlcnR5OiBzdHJpbmcpOiB2b2lkID0+IHtcblx0XHRcdFx0aWYgKCEocHJvcGVydHkgaW4gdmFsdWUpKSB7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Y29uc3QgZGF0ZU1ldGhvZCA9IG9wZXJhdGlvbkhhc2hbcHJvcGVydHldO1xuXHRcdFx0XHQoPGFueT4gcmVzdWx0Ll9kYXRlKVtgc2V0JHtkYXRlTWV0aG9kfWBdKFxuXHRcdFx0XHRcdCg8YW55PiB0aGlzLl9kYXRlKVtgZ2V0JHtkYXRlTWV0aG9kfWBdKCkgKyB2YWx1ZVtwcm9wZXJ0eV1cblx0XHRcdFx0KTtcblxuXHRcdFx0XHRpZiAoKHByb3BlcnR5ID09PSAneWVhcnMnIHx8IHByb3BlcnR5ID09PSAnbW9udGhzJykgJiZcblx0XHRcdFx0XHRyZXN1bHQuZGF5T2ZNb250aCA8IHRoaXMuZGF5T2ZNb250aCkge1xuXHRcdFx0XHRcdC8vIFNldCB0aGUgZGF5IG9mIHRoZSBtb250aCB0byAwIHRvIG1vdmUgdGhlIGRhdGUgdG8gdGhlIGZpcnN0IGRheSBvZiB0aGUgcHJldmlvdXNcblx0XHRcdFx0XHQvLyBtb250aCB0byBmaXggb3ZlcnNob290cyB3aGVuIGFkZGluZyBhIG1vbnRoIGFuZCB0aGUgZGF0ZSBpcyB0aGUgMzFzdCBvciBhZGRpbmdcblx0XHRcdFx0XHQvLyBhIHllYXIgYW5kIHRoZSBkYXRlIGlzIHRoZSAyOXRoXG5cdFx0XHRcdFx0cmVzdWx0LmRheU9mTW9udGggPSAwO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHR9XG5cblx0XHRyZXR1cm4gcmVzdWx0O1xuXHR9XG5cblx0Y29tcGFyZSh2YWx1ZTogRGF0ZU9iamVjdCk6IG51bWJlciB7XG5cdFx0Y29uc3QgcmVzdWx0ID0gdGhpcy50aW1lIC0gdmFsdWUudGltZTtcblx0XHRpZiAocmVzdWx0ID4gMCkge1xuXHRcdFx0cmV0dXJuIDE7XG5cdFx0fVxuXHRcdGlmIChyZXN1bHQgPCAwKSB7XG5cdFx0XHRyZXR1cm4gLTE7XG5cdFx0fVxuXHRcdHJldHVybiAwO1xuXHR9XG5cblx0Y29tcGFyZURhdGUodmFsdWU6IEt3QXJncyk6IG51bWJlciB7XG5cdFx0Y29uc3QgbGVmdCA9IG5ldyBEYXRlT2JqZWN0KHRoaXMpO1xuXHRcdGNvbnN0IHJpZ2h0ID0gbmV3IERhdGVPYmplY3QodmFsdWUpO1xuXG5cdFx0bGVmdC5fZGF0ZS5zZXRIb3VycygwLCAwLCAwLCAwKTtcblx0XHRyaWdodC5fZGF0ZS5zZXRIb3VycygwLCAwLCAwLCAwKTtcblxuXHRcdHJldHVybiBsZWZ0LmNvbXBhcmUocmlnaHQpO1xuXHR9XG5cblx0Y29tcGFyZVRpbWUodmFsdWU6IEt3QXJncyk6IG51bWJlciB7XG5cdFx0Y29uc3QgbGVmdCA9IG5ldyBEYXRlT2JqZWN0KHRoaXMpO1xuXHRcdGNvbnN0IHJpZ2h0ID0gbmV3IERhdGVPYmplY3QodmFsdWUpO1xuXG5cdFx0bGVmdC5fZGF0ZS5zZXRGdWxsWWVhcigwLCAwLCAwKTtcblx0XHRyaWdodC5fZGF0ZS5zZXRGdWxsWWVhcigwLCAwLCAwKTtcblxuXHRcdHJldHVybiBsZWZ0LmNvbXBhcmUocmlnaHQpO1xuXHR9XG5cblx0dG9TdHJpbmcoKTogc3RyaW5nIHtcblx0XHRyZXR1cm4gdGhpcy5fZGF0ZS50b1N0cmluZygpO1xuXHR9XG5cdHRvRGF0ZVN0cmluZygpOiBzdHJpbmcge1xuXHRcdHJldHVybiB0aGlzLl9kYXRlLnRvRGF0ZVN0cmluZygpO1xuXHR9XG5cdHRvVGltZVN0cmluZygpOiBzdHJpbmcge1xuXHRcdHJldHVybiB0aGlzLl9kYXRlLnRvVGltZVN0cmluZygpO1xuXHR9XG5cdHRvTG9jYWxlU3RyaW5nKCk6IHN0cmluZyB7XG5cdFx0cmV0dXJuIHRoaXMuX2RhdGUudG9Mb2NhbGVTdHJpbmcoKTtcblx0fVxuXHR0b0xvY2FsZURhdGVTdHJpbmcoKTogc3RyaW5nIHtcblx0XHRyZXR1cm4gdGhpcy5fZGF0ZS50b0xvY2FsZURhdGVTdHJpbmcoKTtcblx0fVxuXHR0b0xvY2FsZVRpbWVTdHJpbmcoKTogc3RyaW5nIHtcblx0XHRyZXR1cm4gdGhpcy5fZGF0ZS50b0xvY2FsZVRpbWVTdHJpbmcoKTtcblx0fVxuXHR0b0lTT1N0cmluZygpOiBzdHJpbmcge1xuXHRcdHJldHVybiB0aGlzLl9kYXRlLnRvSVNPU3RyaW5nKCk7XG5cdH1cblx0dG9KU09OKGtleT86IGFueSk6IHN0cmluZyB7XG5cdFx0cmV0dXJuIHRoaXMuX2RhdGUudG9KU09OKGtleSk7XG5cdH1cblx0dmFsdWVPZigpOiBudW1iZXIge1xuXHRcdHJldHVybiB0aGlzLl9kYXRlLnZhbHVlT2YoKTtcblx0fVxufVxuIl19