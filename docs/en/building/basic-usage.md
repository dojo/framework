# Basic Usage

Dojo provides a set of CLI commands that assist in creating and building an application. This guide assumes that `@dojo/cli` has been installed globally and [@dojo/cli-build-app](https://github.com/dojo/cli-build-app) and [@dojo/cli-test-intern](https://github.com/dojo/cli-test-intern) are available in the project. If the application was initialized using [@dojo/cli-create-app](https://github.com/dojo/cli-create-app) then these dependencies should already be present.

## Building

There are several types of build targets or `mode`s that Dojo's CLI tool supports. All of these modes can be seen in the various `package.json` scripts generated by `dojo create app`.

Run the following to create an optimized build ready for production.

```bash
> dojo build --mode dist
```

This build will use the `dist` mode to create an application bundle and output the results in the `output/dist` directory.

## Serving and Watching

A web server can be started with the `--serve` flag while running in `dev` or `dist` modes. By default the application is served on port 9999. This can be cahnged with the `--port` flag. Dojo's build tool can also watch the application for changes and automatically rebuild with the `--watch` flag.

The generated `package.json` includes the `dev` script which uses these flags to serve a built version of the application and automatically rebuild it when files change on disk.

```bash
> dojo build --mode dev --watch file --serve
```

The application will also have source maps available. This allows the debugger to map the built JavaScript code back to the original TypeScript code that lives in the `src/` directory.

## Testing

Dojo uses [Intern](https://theintern.io/) for running unit and functional tests.

The fastest way to run unit tests in `tests/unit` is by running them using uses [ts-node](https://www.npmjs.com/package/ts-node) with [@dojo/cli-test-intern](https://github.com/dojo/cli-test-intern)'s JIT builder.

```bash
> dojo test
```

Unit and functional tests

```bash
> dojo build --mode unit
> dojo test --unit --config local
```

This command will build the Dojo application and tests into `dojo\test\unit` and use Intern to run tests locally using node and Chrome.

```bash
> dojo build --mode functional
> dojo test --functional --config local
```

This command will build the Dojo application and functional tests into `dojo\test\functional` and use Intern to execute tests in Chrome using Selenium.

Intern comes with support for running tests remotely on [BrowserStack](https://www.browserstack.com), [SauceLabs](https://saucelabs.com/), and [TestingBot](https://testingbot.com/). You may use one of these services by signing up for an account and providing your credentials to cli-test-intern. By default, all of the testing services will run tests against IE11, Firefox, and Chrome.

More detailed information is available in the [@dojo/cli-test-intern](https://github.com/dojo/cli-test-intern) repository and from [Intern](https://theintern.io/).

## Browser Support

Dojo is an evergreen framework. By default the build will support the last two versions of the latest browsers when it was released. Any polyfills needed by Dojo to normalize functionality across browsers is conditionally provided by the `@dojo/framework/shim`. To support IE11 run the build with the `--legacy` flag.

# Dojo Configuration

Additional configuration options can be added in `.dojorc`. The options generally expand on the settings available through the command line and allow for more advanced features such as internationalization, code splitting, PWA manifests, and eliding code.

`.dojorc` contains a JSON object with configuration information for any of the commands that are run via the dojo command line tool. Each command is allocated a section within the configuration object where its settings can be stored.

```json
{
	"build-app": {
		"pwa": {
			"manifest": {
				"name": "My Application",
				"description": "My amazing application"
			}
		}
	},
	"test-intern": {},
	"create-widget": {
		"tests": "tests/unit"
	}
}
```

In this example we have a section for each of the three CLI command modules: [@dojo/cli-build-app](https://github.com/dojo/cli-build-app/), [@dojo/cli-test-intern](https://github.com/dojo/cli-test-intern), and [@dojo/cli-create-widget](https://github.com/dojo/cli-create-widget). Configuration is _always_ hierarchical and in the order of command => feature => configuration.
